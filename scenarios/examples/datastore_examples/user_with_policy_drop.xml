<?xml version="1.0"?>

<scenario xmlns="http://www.github/gregtampa/HBCTF-Battlegrounds/scenario"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://www.github/gregtampa/HBCTF-Battlegrounds/scenario">

  <!-- Drops an acceptable use policy in html format in the /root directory -->
  <system>
    <system_name>storage_server</system_name>
    <base module_path=".*debian_puppet_32.*"/>

    <vulnerability module_path=".*parameterised_accounts">
      <input into="accounts">
        <generator type="account">
          <input into="username" into_datastore="username1">
            <generator type="username_generator"/>
          </input>
        </generator>
        <generator type="account">
          <input into="username" into_datastore="username2">
            <generator type="username_generator"/>
          </input>
        </generator>
        <generator type="account">
          <input into="username" into_datastore="username3">
            <generator type="username_generator"/>
          </input>
        </generator>
      </input>
    </vulnerability>

    <vulnerability module_path=".*sans_acceptable_use.*">
      <input into="business_name" into_datastore="business_name">
        <generator type="business_name"/>
      </input>
      <input into="username">
        <datastore>username1</datastore>
        <datastore>username2</datastore>
        <datastore>username3</datastore>
      </input>
    </vulnerability>

    <network type="private_network" range="dhcp"/>
  </system>

</scenario>
